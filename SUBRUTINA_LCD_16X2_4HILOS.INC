;***************************************************************************
; SUBRUTINA DE CONTROL Y ESCRITURA EN DISPLAY LCD 16X2 (1602), PARA DIFERENTES 
; FRECUENCIAS DE OPERACION, EN LENGUAJE ENSAMBLADOR, COMPATIBLE PARA DIFERENTES 
; FAMILIAS DE MICOCONTROLADORES AVR DE 8 BITS.
;
; REALIZADA POR ING. C.N. JOSUE NORBERTO MARTINEZ F. (OCTUBRE 2018)
;				produccionesrek@gmail.com
;				http://prdiagramasyelectronica.blogspot.com/
;				https://youtu.be/pxwF1IKu0i0
;***************************************************************************
;
;EL CODIGO DE ESTAS SUBRUTINAS PUEDE SER AGREGADO AL CODIGO DEL PROGRAMA 
;PRINCIPAL O PUEDE SER INCLUIDO UTILIZANDO EL COMANDO ".INCLUDE"
;
;  EJEMPLO:
;  .INCLUDE "SUBRUTINA_LCD_16X2_4HILOS.INC"
;
;
;PARA EJECUTAR ESTA SUBRUTINA SE DEBEN SEGUIR LOS SIGUIENTES PASOS:
;1.- DEFINIR LAS CONSTANTES:
;							FRECUENCIA_MHZ
;							REFERENCIA_CERO
;							DDRX_DISPLAY
;							PORTX_DISPLAY
;							DATA_BIT4
;							DATA_BIT5
;							DATA_BIT6
;							DATA_BIT7
;							REGISTER_SELECT
;							ENABLE_PIN
;
;2.- INICIALIZAR EL DISPLAY EJECUTANDO LA SUBRUTINA:
;							INICIAR_SUBRUTINA_LCD16X2_4HILOS
;
;3.- ENCENDER EL DISPLAY EJECUTANDO LA SUBRUTINA:
;							ENCIENDE_DISPLAY
;
;4.- UTILIZAR EL COMANDO "RCALL" PARA EJECUTAR LA DIFERENTES SUBRUTINAS DE CONTROL
;    Y ESCRITURA DISPONIBLES EN ESTE ARCHIVO
;
;
;5.- NO ES NECESARIO CONFIGURAR EL PUERTO DDR, YA QUE LA CONFIGURACION DE ENTRADAS Y SALIDAS
;    PARA EL DISPLAY SE ENCUENTRA INCLUIDA EN ESTA SUBRUTINA.
;
;
;EJEMPLO DE IMPLEMENTACION:
;---------------------------------------------------------------------
;
;  .EQU FRECUENCIA_MHZ		= 4		;FRECUENCIA DEL MICROCONTROLADOR (MHZ)
;  .EQU REFERENCIA_CERO		= 0		;NO CAMBIAR
;  .EQU DDRX_DISPLAY		= DDRB	;DDRX  (SELECCIONAR PUERTO DE SALIDA DEL AVR)
;  .EQU PORTX_DISPLAY		= PORTB	;PORTX  (SELECCIONAR PUERTO DE SALIDA DEL AVR)
;  .EQU DATA_BIT4		= 0		;PX0  (PIN DE SALIDA)
;  .EQU DATA_BIT5		= 1		;PX1  (PIN DE SALIDA)
;  .EQU DATA_BIT6		= 2		;PX2  (PIN DE SALIDA)
;  .EQU DATA_BIT7		= 3		;PX3  (PIN DE SALIDA)
;  .EQU REGISTER_SELECT		= 4		;PX4  (PIN DE SALIDA)
;  .EQU ENABLE_PIN		= 5		;PX5  (PIN DE SALIDA)
;
;  RCALL INICIAR_SUBRUTINA_LCD16X2_4HILOS	;CONFIGURACION INICIAL
;  RCALL ENCIENDE_DISPLAY			;ENCIENDE DISPLAY, CURSOR EN PRIMERA LINEA
;  RCALL H					;TEXTO EN PRIMER RENGLON "HOLA"
;  RCALL O
;  RCALL L
;  RCALL A
;  RCALL CURSOR_A_LINEA2			;CURSOR EN 2DA LINEA
;  RCALL M					;TEXTO EN SEGUNDO RENGLON "MUNDO"
;  RCALL U
;  RCALL N
;  RCALL D
;  RCALL O
;
;  FIN:						;FIN
;  RJMP FIN
;
;  .INCLUDE "SUBRUTINA_LCD_16X2_4HILOS.INC"
;---------------------------------------------------------------------
;
;ESTA  SUBRUTINA  SOBREESCRIBE  EL  REGISTRO  (R16) DURANTE  LAS 
;OPERACIONES QUE REALIZA
;
;NOTA: CON EL FIN DE DISMINUIR EL TAMAÑO DE MEMORIA UTILIZADO, LAS SUBRUTINAS DE LAS 
;LETRAS Y SIMBOLOS QUE NO SE UTILICEN PUEDEN SER BORRADAS DE ESTE ARCHIVO (OPCIONAL).
;
;***************************************************************************
;LISTA DE SUBRUTINAS DISPONIBLES EN ESTE ARCHIVO
;***************************************************************************
;
;SUBRUTINA							FUNCION
;
;RCALL INICIAR_SUBRUTINA_LCD16X2_4HILOS - - - - CONFIGURA LOS PUERTOS DEL MICROCONTROLADOR
;						Y LOS AJUSTES GENERALES DEL DISPLAY, SE EJECUTA
;						UNA SOLA VEZ AL ENCENDER EL DISPLAY
;RCALL APAGA_DISPLAY - - - - - - - - - - - - -  APAGA EL DISPLAY 
;						(LOS DATOS DEL DISPLAY NO SE BORRAN)
;RCALL BORRA_MEMORIA_DISPLAY - - - - - - - - -  BORRA LOS DATOS DEL DISPLAY
;RCALL ENCIENDE_DISPLAY - - - - - - - - - - - - ENCIENDE EL DISPLAY Y ACTIVA EL CURSOR
;RCALL ENCIENDE_DISPLAY_SIN_CURSOR - - - - - -  ENCIENDE EL DISPLAY SIN CURSOR
;RCALL CURSOR_A_HOME - - - - - - - - - - - - -  COLOCA EL CURSOR EN EL INICIO (IZQUIERDA)
;						DEL PRIMER RENGLON DEL DISPLAY
;RCALL CURSOR_A_LINEA2 - - - - - - - - - - - -  COLOCA EL CURSOR EN EL INICIO (IZQUIERDA)
;						DEL SEGUNDO SENGLON
;RCALL CURSOR_A_LA_DERECHA - - - - - - - - - -  MUEVE EL CURSOR UNA POSICION A LA DERECHA SIN
;						MODIFICAR NINGUN TEXTO EN EL DISPLAY
;RCALL CURSOR_A_LA_IZQUIERDA - - - - - - - - -  MUEVE EL CURSOR UNA POSICION A LA IZQUIERDA SIN
;						MODIFICAR NINGUN TEXTO EN EL DISPLAY
;RCALL DISPLAY_A_LA_DERECHA - - - - - - - - - - MUEVE TODO EL TEXTO DEL DISPLAY UN ESPACIO A LA DERECHA
;						(LA COLUMNA 16 VUELVE A APARECER EN LA COLUMNA 1
;						DESPUES DE HABERSE DESPLAZADO 24 ESPACIOS A LA DERECHA)
;RCALL DISPLAY_A_LA_IZQUIERDA - - - - - - - - - MUEVE TODO EL TEXTO DEL DISPLAY UN ESPACIO A LA IZQUIERDA
;						(LA COLUMNA 1 VUELVE A APARECER EN LA COLUMNA 16
;						DESPUES DE HABERSE DESPLAZADO 24 ESPACIOS A LA IZQUIERDA)
;
;SUBRUTINA				       FUNCION
;
;RCALL A				;ESCRIBE "A" EN EL DISPLAY
;RCALL B				;ESCRIBE "B" EN EL DISPLAY
;RCALL C				;ESCRIBE "C" EN EL DISPLAY
;RCALL D				;ESCRIBE "D" EN EL DISPLAY
;RCALL E				;ESCRIBE "E" EN EL DISPLAY
;	.							.
;	.							.
;	.							.
;RCALL U				;ESCRIBE "U" EN EL DISPLAY
;RCALL V				;ESCRIBE "V" EN EL DISPLAY
;RCALL W				;ESCRIBE "W" EN EL DISPLAY
;RCALL XX				;ESCRIBE "X" EN EL DISPLAY
;RCALL YY				;ESCRIBE "Y" EN EL DISPLAY
;RCALL ZZ				;ESCRIBE "Z" EN EL DISPLAY
;RCALL CERO				;ESCRIBE "0" EN EL DISPLAY
;RCALL UNO				;ESCRIBE "1" EN EL DISPLAY
;RCALL DOS				;ESCRIBE "2" EN EL DISPLAY
;	.							.
;	.							.
;	.							.
;RCALL OCHO				;ESCRIBE "8" EN EL DISPLAY
;RCALL NUEVE				;ESCRIBE "9" EN EL DISPLAY
;RCALL ADMIRACION			;ESCRIBE "!" EN EL DISPLAY
;RCALL COMILLAS				;ESCRIBE " " " EN EL DISPLAY
;RCALL GATO				;ESCRIBE "#" EN EL DISPLAY
;RCALL MONEDA				;ESCRIBE "$" EN EL DISPLAY
;RCALL PORCENTAJE			;ESCRIBE "%" EN EL DISPLAY
;RCALL ABRE_PARENTESIS			;ESCRIBE "(" EN EL DISPLAY
;RCALL CIERRA_PARENTESIS		;ESCRIBE ")" EN EL DISPLAY
;RCALL MAS				;ESCRIBE "+" EN EL DISPLAY
;RCALL COMA				;ESCRIBE "," EN EL DISPLAY
;RCALL MENOS				;ESCRIBE "-" EN EL DISPLAY
;RCALL PUNTO				;ESCRIBE "." EN EL DISPLAY
;RCALL DIAGONAL				;ESCRIBE "/" EN EL DISPLAY
;RCALL DOS_PUNTOS			;ESCRIBE ":" EN EL DISPLAY
;RCALL PUNTO_Y_COMA			;ESCRIBE ";" EN EL DISPLAY
;RCALL MENOR_QUE			;ESCRIBE "<" EN EL DISPLAY
;RCALL IGUAL				;ESCRIBE "=" EN EL DISPLAY
;RCALL MAYOR_QUE			;ESCRIBE ">" EN EL DISPLAY
;RCALL INTERROGACION			;ESCRIBE "?" EN EL DISPLAY
;RCALL POTENCIA				;ESCRIBE SIMBOLO DE POTENCIA DE UN NUMERO
;RCALL GUION_BAJO			;ESCRIBE "_" EN EL DISPLAY
;RCALL FLECHA_DERECHA			;DIBUJA UNA FLECHA APUNTANDO A LA DERECHA
;RCALL FLECHA_IZQUIERDA			;DIBUJA UNA FLECHA APUNTANDO A LA IZQUIERDA
;RCALL GRADOS				;ESCRIBE "°" EN EL DISPLAY
;RCALL MIU				;ESCRIBE LA LETRA GRIEGA "MU", SUFIJO DE "MICRO-"
;RCALL RAIZ_CUADRADA			;ESCRIBE SIMBOLO DE "RAIZ CUADRADA"
;RCALL ENHE				;ESCRIBE "ñ" EN EL DISPLAY
;RCALL INFINITO				;ESCRIBE SIMBOLO DE "INFINITO"
;RCALL OHM				;ESCRIBE EL SIMBOLO DE "OHMS"
;RCALL PI				;ESCRIBE EL SIMBOLO "PI" EN EL DISPLAY
;RCALL ENTRE				;ESCRIBE EL SIMBOLO DE DIVISION EN EL DISPLAY
;RCALL ESPACIO				;DEJA UN ESPACIO VACIO Y AVANZA EL CURSOR
;RCALL RELLENO				;RELLENA UN ESPACIO Y AVANZA EL CURSOR
; 
;***************************************************************************
;DIRECCIONES DE MEMORIA DDRAM, PARA LAS UBICACIONES DEL CURSOR
;FILA:		 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16
;LINEA 1:	00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F
;LINEA 2:	40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F
;
;CODIGO PARA ENVIAR INSTRUCCION AL DISPLAY DE LA POSICION DEL CURSOR
;RS RW DB7 DB6 DB5 DB4 DB3 DB2 DB1 DB0		DATA BIT
; 0  0  1  AC6 AC5 AC4 AC3 AC2 AC1 AC0		ADRESS CURSOR
;
; CURSOR_EN_POSICION:
; CBI PORTX_DISPLAY, REGISTER_SELECT	;LOW = INSTRUCCION
; SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
; SBI PORTX_DISPLAY, DATA_BIT7		;IDENTIFICADOR
; CBI PORTX_DISPLAY, DATA_BIT6		;AC6
; CBI PORTX_DISPLAY, DATA_BIT5		;AC5
; CBI PORTX_DISPLAY, DATA_BIT4		;AC4
; RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
; CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
; NOP
; SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
; CBI PORTX_DISPLAY, DATA_BIT7		;AC3
; CBI PORTX_DISPLAY, DATA_BIT6		;AC2
; CBI PORTX_DISPLAY, DATA_BIT5		;AC1
; CBI PORTX_DISPLAY, DATA_BIT4		;AC0
; RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
; CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
; RCALL DELAY_40US
; RET
;***************************************************************************
INICIAR_SUBRUTINA_LCD16X2_4HILOS:

RCALL RETARDO_ESTABILIZACION_MODULO
RCALL CONFIGURACION_SALIDAS_SUBRUTINA_LCD_16X2
RCALL SECUENCIA_RETARDOS_INICIALES
RCALL CONFIGURACION_INICIAL

RET
;******************************************
;CONFIGURACION DE SALIDAS

CONFIGURACION_SALIDAS_SUBRUTINA_LCD_16X2:

SBI DDRX_DISPLAY, DATA_BIT4
SBI DDRX_DISPLAY, DATA_BIT5
SBI DDRX_DISPLAY, DATA_BIT6
SBI DDRX_DISPLAY, DATA_BIT7
SBI DDRX_DISPLAY, REGISTER_SELECT
SBI DDRX_DISPLAY, ENABLE_PIN

RET
;******************************************
;SECUENCIA DE RETARDOS INICIALES
;DE ACUERDO A LA HOJA DE DATOS DEL LCD

SECUENCIA_RETARDOS_INICIALES:

CBI PORTX_DISPLAY, REGISTER_SELECT	;LOW = INSTRUCCION
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE

RCALL DELAY_2MS						;RETARDO >4.1ms
RCALL DELAY_2MS

CBI PORTX_DISPLAY, REGISTER_SELECT	;LOW = INSTRUCCION
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE

RCALL DELAY_40US					;RETARDO >100us
RCALL DELAY_40US
RCALL DELAY_40US

CBI PORTX_DISPLAY, REGISTER_SELECT	;LOW = INSTRUCCION
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE

RCALL DELAY_2MS

RET
;******************************************
;CONFIGURACION INICIAL

CONFIGURACION_INICIAL:

;CONFIGURA MODO DE 4 BITS
CBI PORTX_DISPLAY, REGISTER_SELECT	;LOW = INSTRUCCION
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		;MODO 4 BITS
CBI PORTX_DISPLAY, DATA_BIT4		;MODO 4 BITS
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE

RCALL DELAY_40US

;ESPECIFICA NUMERO DE LINEAS Y TIPO DE FUENTE
;1ERA PARTE
CBI PORTX_DISPLAY, REGISTER_SELECT	;LOW = INSTRUCCION
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		;MODO 4 BITS
CBI PORTX_DISPLAY, DATA_BIT4		;MODO 4 BITS
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

;2A PARTE
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
SBI PORTX_DISPLAY, DATA_BIT7		;MODO "2 LINEAS EN PANTALLA"
SBI PORTX_DISPLAY, DATA_BIT6		;FORMATO DE PUNTOS 5X11
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE

RCALL DELAY_40US

RCALL APAGA_DISPLAY

RCALL BORRA_MEMORIA_DISPLAY

;CONFIGURACION DEL MODO DE ENTRADA
;1ERA PARTE
CBI PORTX_DISPLAY, REGISTER_SELECT	;LOW = INSTRUCCION
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

;2A PARTE
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
SBI PORTX_DISPLAY, DATA_BIT6		;IDENTIFICADOR
SBI PORTX_DISPLAY, DATA_BIT5		;1 = CURSOR A LA DERECHA
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE

RCALL DELAY_40US

RET
;******************************************
;APAGA DISPLAY

APAGA_DISPLAY:

;1ERA PARTE
CBI PORTX_DISPLAY, REGISTER_SELECT	;LOW = INSTRUCCION
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

;2A PARTE
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
SBI PORTX_DISPLAY, DATA_BIT7		;IDENTIFICADOR
CBI PORTX_DISPLAY, DATA_BIT6		;0 = OFF
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE

RCALL DELAY_40US

RET
;******************************************
;BORRA MEMORIA DEL DISPLAY

BORRA_MEMORIA_DISPLAY:

;1ERA PARTE
CBI PORTX_DISPLAY, REGISTER_SELECT	;LOW = INSTRUCCION
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

;2A PARTE
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE

RCALL DELAY_2MS

RET
;******************************************
;ENCIENDE DISPLAY

ENCIENDE_DISPLAY:

;1ERA PARTE
CBI PORTX_DISPLAY, REGISTER_SELECT	;LOW = INSTRUCCION
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

;2A PARTE
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
SBI PORTX_DISPLAY, DATA_BIT7		;IDENTIFICADOR
SBI PORTX_DISPLAY, DATA_BIT6		;1 = ENCIENDE DISPLAY
SBI PORTX_DISPLAY, DATA_BIT5		;1 = CURSOR ACTIVADO
SBI PORTX_DISPLAY, DATA_BIT4		;1 = CURSOR INTERMITENTE ACTIVADO
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE

RCALL DELAY_40US

RET
;******************************************
;ENCIENDE DISPLAY SIN CURSOR

ENCIENDE_DISPLAY_SIN_CURSOR:

;1ERA PARTE
CBI PORTX_DISPLAY, REGISTER_SELECT	;LOW = INSTRUCCION
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

;2A PARTE
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
SBI PORTX_DISPLAY, DATA_BIT7		;IDENTIFICADOR
SBI PORTX_DISPLAY, DATA_BIT6		;1 = ENCIENDE DISPLAY
CBI PORTX_DISPLAY, DATA_BIT5		;1 = CURSOR ACTIVADO
CBI PORTX_DISPLAY, DATA_BIT4		;1 = CURSOR INTERMITENTE ACTIVADO
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE

RCALL DELAY_40US

RET
;******************************************
;RETORNA EL CURSOR A LA POSICION DE INICIO

CURSOR_A_HOME:

;1ERA PARTE
CBI PORTX_DISPLAY, REGISTER_SELECT	;LOW = INSTRUCCION
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

;2A PARTE
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		;IDENTIFICADOR
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE

RCALL DELAY_2MS

RET
;******************************************
;COLOCA CURSOR EN LA LINEA 2

CURSOR_A_LINEA2:

;1ERA PARTE
CBI PORTX_DISPLAY, REGISTER_SELECT	;LOW = INSTRUCCION
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
SBI PORTX_DISPLAY, DATA_BIT7		;IDENTIFICADOR
SBI PORTX_DISPLAY, DATA_BIT6		;$40
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

;2A PARTE
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE

RCALL DELAY_40US

RET
;******************************************
;MOVER CURSOR A LA DERECHA

CURSOR_A_LA_DERECHA:

;1ERA PARTE
CBI PORTX_DISPLAY, REGISTER_SELECT	;LOW = INSTRUCCION
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		;IDENTIFICADOR
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

;2A PARTE
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
SBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE

RCALL DELAY_40US

RET
;******************************************
;MOVER CURSOR A LA IZQUIERDA

CURSOR_A_LA_IZQUIERDA:

;1ERA PARTE
CBI PORTX_DISPLAY, REGISTER_SELECT	;LOW = INSTRUCCION
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		;IDENTIFICADOR
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

;2A PARTE
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE

RCALL DELAY_40US

RET
;******************************************
;MOVER TODO EL TEXTO DEL DISPLAY A LA DERECHA

DISPLAY_A_LA_DERECHA:

;1ERA PARTE
CBI PORTX_DISPLAY, REGISTER_SELECT	;LOW = INSTRUCCION
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		;IDENTIFICADOR
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

;2A PARTE
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
SBI PORTX_DISPLAY, DATA_BIT7		
SBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE

RCALL DELAY_40US

RET
;******************************************
;MOVER TODO EL TEXTO DEL DISPLAY A LA IZQUIERDA

DISPLAY_A_LA_IZQUIERDA:

;1ERA PARTE
CBI PORTX_DISPLAY, REGISTER_SELECT	;LOW = INSTRUCCION
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		;IDENTIFICADOR
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

;2A PARTE
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
SBI PORTX_DISPLAY, DATA_BIT7		
CBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE

RCALL DELAY_40US

RET
;***********************************************************
;ABECEDARIO (PUEDEN ELIMINARSE LAS LETRAS QUE NO SE UTILICEN)
;***********************************************************

A:
;1ERA PARTE
RCALL QUINTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LLLH_FILA_LOWER_4BIT
RET

B:
;1ERA PARTE
RCALL QUINTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LLHL_FILA_LOWER_4BIT
RET

C:
;1ERA PARTE
RCALL QUINTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LLHH_FILA_LOWER_4BIT
RET

D:
;1ERA PARTE
RCALL QUINTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LHLL_FILA_LOWER_4BIT
RET

E:
;1ERA PARTE
RCALL QUINTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LHLH_FILA_LOWER_4BIT
RET

F:
;1ERA PARTE
RCALL QUINTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LHHL_FILA_LOWER_4BIT
RET

G:
;1ERA PARTE
RCALL QUINTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LHHH_FILA_LOWER_4BIT
RET

H:
;1ERA PARTE
RCALL QUINTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HLLL_FILA_LOWER_4BIT
RET

I:
;1ERA PARTE
RCALL QUINTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HLLH_FILA_LOWER_4BIT
RET

J:
;1ERA PARTE
RCALL QUINTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HLHL_FILA_LOWER_4BIT
RET

K:
;1ERA PARTE
RCALL QUINTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HLHH_FILA_LOWER_4BIT
RET

L:
;1ERA PARTE
RCALL QUINTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHLL_FILA_LOWER_4BIT
RET

M:
;1ERA PARTE
RCALL QUINTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHLH_FILA_LOWER_4BIT
RET

N:
;1ERA PARTE
RCALL QUINTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHHL_FILA_LOWER_4BIT
RET

O:
;1ERA PARTE
RCALL QUINTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHHH_FILA_LOWER_4BIT
RET

P:
;1ERA PARTE
RCALL SEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LLLL_FILA_LOWER_4BIT
RET

Q:
;1ERA PARTE
RCALL SEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LLLH_FILA_LOWER_4BIT
RET

R:
;1ERA PARTE
RCALL SEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LLHL_FILA_LOWER_4BIT
RET

S:
;1ERA PARTE
RCALL SEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LLHH_FILA_LOWER_4BIT
RET

T:
;1ERA PARTE
RCALL SEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LHLL_FILA_LOWER_4BIT
RET

U:
;1ERA PARTE
RCALL SEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LHLH_FILA_LOWER_4BIT
RET

V:
;1ERA PARTE
RCALL SEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LHHL_FILA_LOWER_4BIT
RET

W:
;1ERA PARTE
RCALL SEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LHHH_FILA_LOWER_4BIT
RET

XX:
;1ERA PARTE
RCALL SEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HLLL_FILA_LOWER_4BIT
RET

YY:
;1ERA PARTE
RCALL SEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HLLH_FILA_LOWER_4BIT
RET

ZZ:
;1ERA PARTE
RCALL SEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HLHL_FILA_LOWER_4BIT
RET
;***********************************************************
;NUMEROS DEL 0 AL 9 (PUEDEN ELIMINARSE LOS NÚMEROS QUE NO SE UTILICEN)
;***********************************************************

CERO:
;1ERA PARTE
RCALL CUARTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LLLL_FILA_LOWER_4BIT
RET

UNO:
;1ERA PARTE
RCALL CUARTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LLLH_FILA_LOWER_4BIT
RET

DOS:
;1ERA PARTE
RCALL CUARTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LLHL_FILA_LOWER_4BIT
RET

TRES:
;1ERA PARTE
RCALL CUARTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LLHH_FILA_LOWER_4BIT
RET

CUATRO:
;1ERA PARTE
RCALL CUARTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LHLL_FILA_LOWER_4BIT
RET

CINCO:
;1ERA PARTE
RCALL CUARTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LHLH_FILA_LOWER_4BIT
RET

SEIS:
;1ERA PARTE
RCALL CUARTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LHHL_FILA_LOWER_4BIT
RET

SIETE:
;1ERA PARTE
RCALL CUARTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LHHH_FILA_LOWER_4BIT
RET

OCHO:
;1ERA PARTE
RCALL CUARTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HLLL_FILA_LOWER_4BIT
RET

NUEVE:
;1ERA PARTE
RCALL CUARTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HLLH_FILA_LOWER_4BIT
RET
;***********************************************************
;SIMBOLOS Y OTROS (PUEDEN ELIMINARSE LOS SIMBOLOS QUE NO SE UTILICEN)
;***********************************************************

ADMIRACION:
;1ERA PARTE
RCALL TERCERA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LLLH_FILA_LOWER_4BIT
RET

COMILLAS:
;1ERA PARTE
RCALL TERCERA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LLHL_FILA_LOWER_4BIT
RET

GATO:
;1ERA PARTE
RCALL TERCERA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LLHH_FILA_LOWER_4BIT
RET

MONEDA:
;1ERA PARTE
RCALL TERCERA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LHLL_FILA_LOWER_4BIT
RET

PORCENTAJE:
;1ERA PARTE
RCALL TERCERA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LHLH_FILA_LOWER_4BIT
RET

ABRE_PARENTESIS:
;1ERA PARTE
RCALL TERCERA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HLLL_FILA_LOWER_4BIT
RET

CIERRA_PARENTESIS:
;1ERA PARTE
RCALL TERCERA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HLLH_FILA_LOWER_4BIT
RET

MAS:
;1ERA PARTE
RCALL TERCERA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HLHH_FILA_LOWER_4BIT
RET

COMA:
;1ERA PARTE
RCALL TERCERA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHLL_FILA_LOWER_4BIT
RET

MENOS:
;1ERA PARTE
RCALL TERCERA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHLH_FILA_LOWER_4BIT
RET

PUNTO:
;1ERA PARTE
RCALL TERCERA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHHL_FILA_LOWER_4BIT
RET

DIAGONAL:
;1ERA PARTE
RCALL TERCERA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHHH_FILA_LOWER_4BIT
RET

DOS_PUNTOS:
;1ERA PARTE
RCALL CUARTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HLHL_FILA_LOWER_4BIT
RET

PUNTO_Y_COMA:
;1ERA PARTE
RCALL CUARTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HLHH_FILA_LOWER_4BIT
RET

MENOR_QUE:
;1ERA PARTE
RCALL CUARTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHLL_FILA_LOWER_4BIT
RET

IGUAL:
;1ERA PARTE
RCALL CUARTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHLH_FILA_LOWER_4BIT
RET

MAYOR_QUE:
;1ERA PARTE
RCALL CUARTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHHL_FILA_LOWER_4BIT
RET

INTERROGACION:
;1ERA PARTE
RCALL CUARTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHHH_FILA_LOWER_4BIT
RET

POTENCIA:
;1ERA PARTE
RCALL SEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHHL_FILA_LOWER_4BIT
RET

GUION_BAJO:
;1ERA PARTE
RCALL SEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHHH_FILA_LOWER_4BIT
RET

FLECHA_DERECHA:
;1ERA PARTE
RCALL OCTAVA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHHL_FILA_LOWER_4BIT
RET

FLECHA_IZQUIERDA:
;1ERA PARTE
RCALL OCTAVA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHHH_FILA_LOWER_4BIT
RET

GRADOS:
;1ERA PARTE
RCALL DECIMOCUARTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHHH_FILA_LOWER_4BIT
RET

MIU:
;1ERA PARTE
RCALL DECIMOQUINTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LHLL_FILA_LOWER_4BIT
RET

RAIZ_CUADRADA:
;1ERA PARTE
RCALL DECIMOQUINTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HLLL_FILA_LOWER_4BIT
RET

ENHE:
;1ERA PARTE
RCALL DECIMOQUINTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHHL_FILA_LOWER_4BIT
RET

INFINITO:
;1ERA PARTE
RCALL DECIMOSEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LLHH_FILA_LOWER_4BIT
RET

OHM:
;1ERA PARTE
RCALL DECIMOSEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LHLL_FILA_LOWER_4BIT
RET

PI:
;1ERA PARTE
RCALL DECIMOSEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL LHHH_FILA_LOWER_4BIT
RET

ENTRE:
;1ERA PARTE
RCALL DECIMOSEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHLH_FILA_LOWER_4BIT
RET

ESPACIO:
;1ERA PARTE
RCALL DECIMOSEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHHL_FILA_LOWER_4BIT
RET

RELLENO:
;1ERA PARTE
RCALL DECIMOSEXTA_COLUMNA_UPPER_4BIT
;2A PARTE
RCALL HHHH_FILA_LOWER_4BIT
RET
;***********************************************************
;------------- (N O   B O R R A R)--------------
;***********************************************************
;FILA LLLL, 4BITS MENOS SIGNIFICATIVOS

LLLL_FILA_LOWER_4BIT:

SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		;0000
CBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
RCALL DELAY_40US

RET
;******************************************
;FILA LLLH, 4BITS MENOS SIGNIFICATIVOS

LLLH_FILA_LOWER_4BIT:

SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		;0001
CBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
RCALL DELAY_40US

RET
;******************************************
;FILA LLHL, 4BITS MENOS SIGNIFICATIVOS

LLHL_FILA_LOWER_4BIT:

SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		;0010
CBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
RCALL DELAY_40US

RET
;******************************************
;FILA LLHH, 4BITS MENOS SIGNIFICATIVOS

LLHH_FILA_LOWER_4BIT:

SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		;0011
CBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
RCALL DELAY_40US

RET
;******************************************
;FILA LHLL, 4BITS MENOS SIGNIFICATIVOS

LHLL_FILA_LOWER_4BIT:

SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		;0100
SBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
RCALL DELAY_40US

RET
;******************************************
;FILA LHLH, 4BITS MENOS SIGNIFICATIVOS

LHLH_FILA_LOWER_4BIT:

SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		;0101
SBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
RCALL DELAY_40US

RET
;******************************************
;FILA LHHL, 4BITS MENOS SIGNIFICATIVOS

LHHL_FILA_LOWER_4BIT:

SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		;0110
SBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
RCALL DELAY_40US

RET
;******************************************
;FILA LHHH, 4BITS MENOS SIGNIFICATIVOS

LHHH_FILA_LOWER_4BIT:

SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		;0111
SBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
RCALL DELAY_40US

RET
;******************************************
;FILA HLLL, 4BITS MENOS SIGNIFICATIVOS

HLLL_FILA_LOWER_4BIT:

SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
SBI PORTX_DISPLAY, DATA_BIT7		;1000
CBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
RCALL DELAY_40US

RET
;******************************************
;FILA HLLH, 4BITS MENOS SIGNIFICATIVOS

HLLH_FILA_LOWER_4BIT:

SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
SBI PORTX_DISPLAY, DATA_BIT7		;1001
CBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
RCALL DELAY_40US

RET
;******************************************
;FILA HLHL, 4BITS MENOS SIGNIFICATIVOS

HLHL_FILA_LOWER_4BIT:

SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
SBI PORTX_DISPLAY, DATA_BIT7		;1010
CBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
RCALL DELAY_40US

RET
;******************************************
;FILA HLHH, 4BITS MENOS SIGNIFICATIVOS

HLHH_FILA_LOWER_4BIT:

SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
SBI PORTX_DISPLAY, DATA_BIT7		;1011
CBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
RCALL DELAY_40US

RET
;******************************************
;FILA HHLL, 4BITS MENOS SIGNIFICATIVOS

HHLL_FILA_LOWER_4BIT:

SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
SBI PORTX_DISPLAY, DATA_BIT7		;1100
SBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
RCALL DELAY_40US

RET
;******************************************
;FILA HHLH, 4BITS MENOS SIGNIFICATIVOS

HHLH_FILA_LOWER_4BIT:

SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
SBI PORTX_DISPLAY, DATA_BIT7		;1101
SBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
RCALL DELAY_40US

RET
;******************************************
;FILA HHHL, 4BITS MENOS SIGNIFICATIVOS

HHHL_FILA_LOWER_4BIT:

SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
SBI PORTX_DISPLAY, DATA_BIT7		;1110
SBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
RCALL DELAY_40US

RET
;******************************************
;FILA HHHH, 4BITS MENOS SIGNIFICATIVOS

HHHH_FILA_LOWER_4BIT:

SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
SBI PORTX_DISPLAY, DATA_BIT7		;1111
SBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
RCALL DELAY_40US

RET
;******************************************
;3RA COLUMNA, 4BITS MAS SIGNIFICATIVOS

TERCERA_COLUMNA_UPPER_4BIT:

SBI PORTX_DISPLAY, REGISTER_SELECT	;HIGH = DATA
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		;0010
CBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

RET
;******************************************
;4TA COLUMNA, 4BITS MAS SIGNIFICATIVOS

CUARTA_COLUMNA_UPPER_4BIT:

SBI PORTX_DISPLAY, REGISTER_SELECT	;HIGH = DATA
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		;0011
CBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

RET
;******************************************
;5TA COLUMNA, 4BITS MAS SIGNIFICATIVOS

QUINTA_COLUMNA_UPPER_4BIT:

SBI PORTX_DISPLAY, REGISTER_SELECT	;HIGH = DATA
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		;0100
SBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

RET
;******************************************
;6TA COLUMNA, 4BITS MAS SIGNIFICATIVOS

SEXTA_COLUMNA_UPPER_4BIT:

SBI PORTX_DISPLAY, REGISTER_SELECT	;HIGH = DATA
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		;0101
SBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

RET
;******************************************
;7MA COLUMNA, 4BITS MAS SIGNIFICATIVOS

SEPTIMA_COLUMNA_UPPER_4BIT:

SBI PORTX_DISPLAY, REGISTER_SELECT	;HIGH = DATA
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		;0110
SBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

RET
;******************************************
;8VA COLUMNA, 4BITS MAS SIGNIFICATIVOS

OCTAVA_COLUMNA_UPPER_4BIT:

SBI PORTX_DISPLAY, REGISTER_SELECT	;HIGH = DATA
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
CBI PORTX_DISPLAY, DATA_BIT7		;0111
SBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

RET
;******************************************
;14A COLUMNA, 4BITS MAS SIGNIFICATIVOS

DECIMOCUARTA_COLUMNA_UPPER_4BIT:

SBI PORTX_DISPLAY, REGISTER_SELECT	;HIGH = DATA
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
SBI PORTX_DISPLAY, DATA_BIT7		;1101
SBI PORTX_DISPLAY, DATA_BIT6		
CBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

RET
;******************************************
;15A COLUMNA, 4BITS MAS SIGNIFICATIVOS

DECIMOQUINTA_COLUMNA_UPPER_4BIT:

SBI PORTX_DISPLAY, REGISTER_SELECT	;HIGH = DATA
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
SBI PORTX_DISPLAY, DATA_BIT7		;1110
SBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		
CBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

RET
;******************************************
;16A COLUMNA, 4BITS MAS SIGNIFICATIVOS

DECIMOSEXTA_COLUMNA_UPPER_4BIT:

SBI PORTX_DISPLAY, REGISTER_SELECT	;HIGH = DATA
SBI PORTX_DISPLAY, ENABLE_PIN		;INICIA PULSO ENABLE
SBI PORTX_DISPLAY, DATA_BIT7		;1111
SBI PORTX_DISPLAY, DATA_BIT6		
SBI PORTX_DISPLAY, DATA_BIT5		
SBI PORTX_DISPLAY, DATA_BIT4		
RCALL DELAY_PULSO_ENABLE			;RETARDO DEL PULSO ENABLE
CBI PORTX_DISPLAY, ENABLE_PIN		;TERMINA PULSO ENABLE
NOP

RET
;******************************************
;GENERA RETARDO
;DELAY 40us APROX

DELAY_40US:

LDI R16, 4
DELAY_40US_LOOP1:
DEC R16
PUSH R16
RCALL DELAY_PULSO_ENABLE
POP R16
CPI R16, REFERENCIA_CERO
BRNE DELAY_40US_LOOP1

RET
;******************************************
;GENERA UN RETARDO 10us aprox.
;DURACION DEL PULSO "ENABLE"

DELAY_PULSO_ENABLE:

LDI R16, FRECUENCIA_MHZ
DELAY_PULSO_ENABLE_LOOP1:
NOP
NOP
NOP
NOP
DEC R16
CPI R16, REFERENCIA_CERO
BRNE DELAY_PULSO_ENABLE_LOOP1

RET
;******************************************
;GENERA RETARDO DE 2ms APROX

DELAY_2MS:

LDI R16, FRECUENCIA_MHZ

DELAY_2MS_LOOP2:
DEC R16
PUSH R16
LDI R16, $FF
DELAY_2MS_LOOP1:
NOP
NOP
NOP
NOP
DEC R16
CPI R16, REFERENCIA_CERO
BRNE DELAY_2MS_LOOP1
POP R16
CPI R16, REFERENCIA_CERO
BRNE DELAY_2MS_LOOP2

RET
;******************************************
;GENERA UN RETARDO 50ms aprox.
;ESTABILIZACION MODULO LCD

RETARDO_ESTABILIZACION_MODULO:

LDI R16, $17
RETARDO_ESTABILIZACION_MODULO_LOOP1:
DEC R16
PUSH R16
RCALL DELAY_2MS
POP R16
CPI R16, REFERENCIA_CERO
BRNE RETARDO_ESTABILIZACION_MODULO_LOOP1

RET
;******************************************
